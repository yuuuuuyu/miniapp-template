# Husky é…ç½®ä¼˜åŒ–æ€»ç»“

## ä¼˜åŒ–å†…å®¹

### 1. è‡ªåŠ¨æ–‡ä»¶æš‚å­˜
- âœ… **pre-commit hook** è‡ªåŠ¨æ‰§è¡Œ `git add .`
- âœ… **commit è„šæœ¬** è‡ªåŠ¨æš‚å­˜ä¿®æ”¹çš„æ–‡ä»¶
- âŒ ä¸å†éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ `git add`

### 2. ç®€åŒ–é…ç½®æ–‡ä»¶

#### `.husky/pre-commit`
```bash
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” æ‰§è¡Œ pre-commit æ£€æŸ¥..."

# æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶éœ€è¦æš‚å­˜
if [ -n "$(git diff --name-only)" ]; then
  echo "ğŸ“ è‡ªåŠ¨æš‚å­˜ä¿®æ”¹çš„æ–‡ä»¶..."
  git add .
fi

echo "âœ… Pre-commit æ£€æŸ¥å®Œæˆ"
```

#### `commitlint.config.js` - æ•´åˆç‰ˆ
- æ•´åˆäº†åŸ `.cz-config.js` çš„ç±»å‹å’ŒèŒƒå›´å®šä¹‰
- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œé¿å…é‡å¤
- å¯¼å‡ºé…ç½®ä¾›å…¶ä»–è„šæœ¬ä½¿ç”¨
- åˆ é™¤äº†å†—ä½™çš„ `.cz-config.js` æ–‡ä»¶

### 3. è„šæœ¬ä¼˜åŒ–

#### `scripts/commit.js`
- è‡ªåŠ¨æ£€æµ‹ä¿®æ”¹çš„æ–‡ä»¶
- è‡ªåŠ¨æš‚å­˜æ–‡ä»¶
- ç§»é™¤æ‰‹åŠ¨ `git add` è¦æ±‚
- ä» `commitlint.config.js` å¯¼å…¥ç±»å‹å’ŒèŒƒå›´å®šä¹‰ï¼Œé¿å…é‡å¤

#### `package.json` è„šæœ¬è°ƒæ•´
```json
{
  "scripts": {
    "commit": "node scripts/commit.js",      // ä¸»è¦æäº¤æ–¹å¼
    "commit:cz": "git-cz",                   // å¤‡ç”¨æ–¹å¼
    "commit:test": "node scripts/test-commit.js"  // æµ‹è¯•é…ç½®
  }
}
```

## ä½¿ç”¨æ–¹æ³•

### æ¨èæ–¹å¼ï¼ˆä¸€é”®æäº¤ï¼‰
```bash
npm run commit
```
- è‡ªåŠ¨æš‚å­˜æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
- äº¤äº’å¼å¡«å†™æäº¤ä¿¡æ¯
- è‡ªåŠ¨æ£€æŸ¥æ ¼å¼è§„èŒƒ

### å¤‡ç”¨æ–¹å¼
```bash
npm run commit:cz
```
- ä½¿ç”¨ Commitizen ç•Œé¢
- éœ€è¦æ‰‹åŠ¨ `git add`

### æµ‹è¯•é…ç½®
```bash
npm run commit:test
```
- éªŒè¯ Husky é…ç½®æ˜¯å¦æ­£å¸¸
- æ£€æŸ¥æ‰€æœ‰ä¾èµ–æ˜¯å¦å®‰è£…æ­£ç¡®

## ä¼˜åŒ–æ•ˆæœ

### ä¹‹å‰çš„æµç¨‹
```bash
git add .                    # æ‰‹åŠ¨æš‚å­˜
npm run commit              # æäº¤
```

### ç°åœ¨çš„æµç¨‹
```bash
npm run commit              # ä¸€é”®å®Œæˆ
```

### è‡ªåŠ¨åŒ–åŠŸèƒ½
- âœ… è‡ªåŠ¨æš‚å­˜ä¿®æ”¹çš„æ–‡ä»¶
- âœ… è‡ªåŠ¨æ£€æŸ¥æäº¤ä¿¡æ¯æ ¼å¼
- âœ… æ”¯æŒä¸­æ–‡æè¿°
- âœ… äº¤äº’å¼å¼•å¯¼å¡«å†™
- âœ… å®æ—¶æ ¼å¼éªŒè¯

## æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒé…ç½®æ–‡ä»¶
- `.husky/pre-commit` - é¢„æäº¤é’©å­
- `.husky/commit-msg` - æäº¤ä¿¡æ¯æ£€æŸ¥
- `commitlint.config.js` - ç»Ÿä¸€çš„æäº¤è§„èŒƒé…ç½®ï¼ˆæ•´åˆäº†åŸ .cz-config.jsï¼‰

### è„šæœ¬æ–‡ä»¶
- `scripts/commit.js` - ä¸»è¦æäº¤è„šæœ¬
- `scripts/test-commit.js` - é…ç½®æµ‹è¯•è„šæœ¬
- `scripts/setup-husky.sh` - å®‰è£…è„šæœ¬

### æ–‡æ¡£æ–‡ä»¶
- `COMMIT_GUIDE.md` - ä½¿ç”¨æŒ‡å—
- `HUSKY_OPTIMIZATION.md` - ä¼˜åŒ–è¯´æ˜

## é…ç½®æ•´åˆè¯´æ˜

### åˆ é™¤çš„æ–‡ä»¶
- âŒ `.cz-config.js` - å·²æ•´åˆåˆ° `commitlint.config.js` ä¸­

### æ•´åˆä¼˜åŠ¿
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œé¿å…é‡å¤å®šä¹‰
- âœ… å‡å°‘é…ç½®æ–‡ä»¶æ•°é‡
- âœ… ç±»å‹å’ŒèŒƒå›´å®šä¹‰ä¿æŒä¸€è‡´
- âœ… æ›´æ˜“ç»´æŠ¤å’Œæ›´æ–°

## æ³¨æ„äº‹é¡¹

1. ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š`npm install`
2. é¦–æ¬¡ä½¿ç”¨è¿è¡Œï¼š`npm run commit:test`
3. æ”¯æŒä¸­æ–‡æäº¤ä¿¡æ¯
4. æäº¤ä¿¡æ¯é•¿åº¦é™åˆ¶ï¼š100å­—ç¬¦
5. è‡ªåŠ¨æš‚å­˜åŠŸèƒ½ä»…åœ¨æœ‰ä¿®æ”¹æ–‡ä»¶æ—¶ç”Ÿæ•ˆ
